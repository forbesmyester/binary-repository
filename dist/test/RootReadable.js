"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const RootReadable_1 = require("../src/RootReadable");
const ava_1 = require("ava");
const ramda_1 = require("ramda");
ava_1.default.cb('Can scan a directory', (tst) => {
    let globber = (root, pattern, ignore, next) => {
        setTimeout(() => {
            next(new Error("XXX"), ramda_1.range(0, 100).map(n => "a" + n));
        }, 200);
    };
    let rootReader = new RootReadable_1.RootReadable({ glob: globber }, './test/data', []);
    let error = null;
    let data = [];
    rootReader.on('end', () => {
        tst.is(data.length, 100);
        tst.is(true, rootReader.readBeforeData);
        tst.is(true, rootReader.readAfterData);
        tst.is(error.message, "XXX");
        tst.end();
    });
    rootReader.on('error', (e) => {
        error = e;
    });
    rootReader.on('data', (d) => {
        data.push(d);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUm9vdFJlYWRhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdGVzdC9Sb290UmVhZGFibGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzREFBNkQ7QUFDN0QsNkJBQXVCO0FBQ3ZCLGlDQUE4QjtBQUc5QixhQUFJLENBQUMsRUFBRSxDQUFDLHNCQUFzQixFQUFFLENBQUMsR0FBRztJQUVoQyxJQUFJLE9BQU8sR0FBRyxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQXdCO1FBQzFELFVBQVUsQ0FBQztZQUNQLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxhQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBRyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ1osQ0FBQyxDQUFDO0lBRUYsSUFBSSxVQUFVLEdBQUcsSUFBSSwyQkFBWSxDQUFDLEVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBQyxFQUFFLGFBQWEsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUV0RSxJQUFJLEtBQUssR0FBZSxJQUFJLENBQUM7SUFDN0IsSUFBSSxJQUFJLEdBQWEsRUFBRSxDQUFDO0lBRXhCLFVBQVUsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFO1FBQ2pCLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN6QixHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDeEMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3ZDLEdBQUcsQ0FBQyxFQUFFLENBQVMsS0FBTSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN0QyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDZCxDQUFDLENBQUMsQ0FBQztJQUVILFVBQVUsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNyQixLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBQ2QsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQVM7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNqQixDQUFDLENBQUMsQ0FBQztBQUdQLENBQUMsQ0FBQyxDQUFDIn0=