"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const RootReadable_1 = require("../src/RootReadable");
const ava_1 = require("ava");
const ramda_1 = require("ramda");
ava_1.default.cb('Can scan a directory', (tst) => {
    let globber = (root, pattern, ignore, next) => {
        setTimeout(() => {
            next(new Error("XXX"), ramda_1.range(0, 100).map(n => "a" + n));
        }, 200);
    };
    let rootReader = new RootReadable_1.RootReadable({ glob: globber }, './test/data', []);
    let error = null;
    let data = [];
    rootReader.on('end', () => {
        tst.is(data.length, 100);
        tst.is(true, rootReader.readBeforeData);
        tst.is(true, rootReader.readAfterData);
        tst.is(error.message, "XXX");
        tst.end();
    });
    rootReader.on('error', (e) => {
        error = e;
    });
    rootReader.on('data', (d) => {
        data.push(d);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUm9vdFJlYWRhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdGVzdC9Sb290UmVhZGFibGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzREFBNkQ7QUFDN0QsNkJBQXVCO0FBQ3ZCLGlDQUE4QjtBQUU5QixhQUFJLENBQUMsRUFBRSxDQUFDLHNCQUFzQixFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUU7SUFFcEMsSUFBSSxPQUFPLEdBQUcsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxJQUF3QixFQUFFLEVBQUU7UUFDOUQsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxhQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUcsQ0FBQyxDQUFDO1FBQzlELENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNaLENBQUMsQ0FBQztJQUVGLElBQUksVUFBVSxHQUFHLElBQUksMkJBQVksQ0FBQyxFQUFDLElBQUksRUFBRSxPQUFPLEVBQUMsRUFBRSxhQUFhLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFdEUsSUFBSSxLQUFLLEdBQWUsSUFBSSxDQUFDO0lBQzdCLElBQUksSUFBSSxHQUFhLEVBQUUsQ0FBQztJQUV4QixVQUFVLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUU7UUFDdEIsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUN4QyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDdkMsR0FBRyxDQUFDLEVBQUUsQ0FBUyxLQUFNLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUNkLENBQUMsQ0FBQyxDQUFDO0lBRUgsVUFBVSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtRQUN6QixLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBQ2QsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQVMsRUFBRSxFQUFFO1FBQ2hDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakIsQ0FBQyxDQUFDLENBQUM7QUFHUCxDQUFDLENBQUMsQ0FBQyJ9